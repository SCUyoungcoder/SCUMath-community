<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--https://mybatis.org/mybatis-3/zh/getting-started.html入门找已映射的sql语句copy过来-->
<mapper namespace="com.nowcoder.community.dao.BlogMapper">

    <resultMap id="BaseResultMap" type="com.nowcoder.community.entity.Blog">
        <!--@mbg.generated-->
        <!--@Table kuangstudy.ks_blog-->
        <id column="id" jdbcType="INTEGER" property="id" />
        <result column="bid" jdbcType="VARCHAR" property="bid" />
        <result column="title" jdbcType="VARCHAR" property="title" />
        <result column="content" jdbcType="LONGVARCHAR" property="content" />
        <result column="sort" jdbcType="INTEGER" property="sort" />
        <result column="views" jdbcType="INTEGER" property="views" />
        <result column="author_id" jdbcType="INTEGER" property="authorId" />
        <result column="author_name" jdbcType="VARCHAR" property="authorName" />
        <result column="author_avatar" jdbcType="VARCHAR" property="authorAvatar" />
        <result column="category_id" jdbcType="INTEGER" property="categoryId" />
        <result column="category_name" jdbcType="VARCHAR" property="categoryName" />
        <result column="gmt_create" jdbcType="TIMESTAMP" property="gmtCreate" />
        <result column="gmt_update" jdbcType="TIMESTAMP" property="gmtUpdate" />
    </resultMap>
    <sql id="Base_Column_List">
        <!--@mbg.generated-->
        id, bid, title, content, sort, views, author_id, author_name, author_avatar, category_id,
        category_name, gmt_create, gmt_update
    </sql>

    <insert id="insertBlog" keyColumn="id" keyProperty="id" parameterType="com.nowcoder.community.entity.Blog" useGeneratedKeys="true">
        <!--@mbg.generated-->
        insert into blog
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="bid != null and bid != ''">
                bid,
            </if>
            <if test="title != null and title != ''">
                title,
            </if>
            <if test="content != null and content != ''">
                content,
            </if>
            <if test="sort != null">
                sort,
            </if>
            <if test="views != null">
                views,
            </if>
            <if test="authorId != null and authorId != ''">
                author_id,
            </if>
            <if test="authorName != null and authorName != ''">
                author_name,
            </if>
            <if test="authorAvatar != null and authorAvatar != ''">
                author_avatar,
            </if>
            <if test="categoryId != null">
                category_id,
            </if>
            <if test="categoryName != null and categoryName != ''">
                category_name,
            </if>
            <if test="gmtCreate != null">
                gmt_create,
            </if>
            <if test="gmtUpdate != null">
                gmt_update,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="bid != null and bid != ''">
                #{bid,jdbcType=VARCHAR},
            </if>
            <if test="title != null and title != ''">
                #{title,jdbcType=VARCHAR},
            </if>
            <if test="content != null and content != ''">
                #{content,jdbcType=LONGVARCHAR},
            </if>
            <if test="sort != null">
                #{sort,jdbcType=INTEGER},
            </if>
            <if test="views != null">
                #{views,jdbcType=INTEGER},
            </if>
            <if test="authorId != null and authorId != ''">
                #{authorId,jdbcType=INTEGER},
            </if>
            <if test="authorName != null and authorName != ''">
                #{authorName,jdbcType=VARCHAR},
            </if>
            <if test="authorAvatar != null and authorAvatar != ''">
                #{authorAvatar,jdbcType=VARCHAR},
            </if>
            <if test="categoryId != null">
                #{categoryId,jdbcType=INTEGER},
            </if>
            <if test="categoryName != null and categoryName != ''">
                #{categoryName,jdbcType=VARCHAR},
            </if>
            <if test="gmtCreate != null">
                #{gmtCreate,jdbcType=TIMESTAMP},
            </if>
            <if test="gmtUpdate != null">
                #{gmtUpdate,jdbcType=TIMESTAMP},
            </if>
        </trim>
    </insert>


    <select id="selectByBid" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from blog
        where bid=#{bid,jdbcType=VARCHAR}
    </select>
    <update id="updateViews">
        update paper set views = #{count} where id = #{id}
    </update>
</mapper>